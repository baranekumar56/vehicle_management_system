<!DOCTYPE html>
<html lang="en" class="scroll-smooth" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Garage Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#241358',
          },
        },
      },
    }
  </script>
  <style>
    /* Styles inherited from issues.html */

    /* Modal backdrop */
    .modal-bg {
      background-color: rgba(0, 0, 0, 0.7);
    }

    /* Toggle switch styles from issues.html */
    .toggle-checkbox:checked {
      @apply border-primary bg-primary;
    }
    .toggle-checkbox:checked + .toggle-label {
      @apply bg-primary;
    }
    .toggle-checkbox:checked + .toggle-label:before {
      @apply translate-x-6;
    }

    /*
      Other styles are inherited through tailwind utility classes consistent with issues.html
    */
  </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">

  <!-- Navbar and Sidebar placeholders for consistency -->
  <div id="sidebar-root"></div>
  <div id="navbar-root"></div>

  <main class="pt-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
    <h1 class="text-3xl font-semibold text-primary mb-6">Garage Management</h1>

    <!-- Auto Schedule toggle -->
    <section class="mb-6 flex items-center space-x-4">
      <label for="auto-schedule-toggle" class="font-semibold text-gray-800 select-none">Auto Schedule</label>

      <div class="relative inline-block w-14 align-middle select-none transition duration-200 ease-in">
        <input type="checkbox" id="auto-schedule-toggle" class="toggle-checkbox absolute block w-7 h-7 rounded-full bg-white border-4 border-gray-300 cursor-pointer appearance-none checked:border-primary checked:bg-primary" />
        <label for="auto-schedule-toggle" class="toggle-label block overflow-hidden h-7 rounded-full bg-gray-300 cursor-pointer"></label>
      </div>
    </section>

    <!-- Shed Status Cards -->
    <section aria-label="Shed Status" class="mb-10">
      <h2 class="text-xl font-semibold mb-4">Shed Status</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

        <!-- Shed 1 -->
        <div class="bg-white rounded shadow p-6 flex flex-col">
          <h3 class="font-semibold mb-2">Shed 1</h3>
          <p class="mb-4">Toyota Corolla</p>

          <button data-view-shed="1" class="text-primary underline font-semibold hover:text-primary/80 focus:outline-none">View</button>
          <button data-update-shed="1" class="mt-3 bg-primary text-white rounded px-4 py-1 hover:bg-primary/90 focus:outline-none">Update Sheds</button>

          <div class="mt-4 hidden update-counter flex items-center space-x-3">
            <button aria-label="Decrement" class="btn-decrement bg-gray-200 rounded px-2 py-1 hover:bg-gray-300">-</button>
            <span class="counter-value font-semibold text-lg">0</span>
            <button aria-label="Increment" class="btn-increment bg-gray-200 rounded px-2 py-1 hover:bg-gray-300">+</button>
          </div>

          <button class="mt-3 bg-green-600 text-white rounded px-4 py-1 hover:bg-green-700 focus:outline-none hidden update-status-btn">Update Status</button>
        </div>

        <!-- Shed 2 -->
        <div class="bg-white rounded shadow p-6 flex flex-col">
          <h3 class="font-semibold mb-2">Shed 2</h3>
          <p class="mb-4">Honda Civic</p>

          <button data-view-shed="2" class="text-primary underline font-semibold hover:text-primary/80 focus:outline-none">View</button>
          <button data-update-shed="2" class="mt-3 bg-primary text-white rounded px-4 py-1 hover:bg-primary/90 focus:outline-none">Update Sheds</button>

          <div class="mt-4 hidden update-counter flex items-center space-x-3">
            <button aria-label="Decrement" class="btn-decrement bg-gray-200 rounded px-2 py-1 hover:bg-gray-300">-</button>
            <span class="counter-value font-semibold text-lg">0</span>
            <button aria-label="Increment" class="btn-increment bg-gray-200 rounded px-2 py-1 hover:bg-gray-300">+</button>
          </div>

          <button class="mt-3 bg-green-600 text-white rounded px-4 py-1 hover:bg-green-700 focus:outline-none hidden update-status-btn">Update Status</button>
        </div>

        <!-- Bottom Shed static info -->
        <div aria-label="Bottom Shed Status" class="bg-white rounded shadow p-6 flex flex-col items-center">
          <h3 class="font-semibold mb-4">Bottom Shed Status</h3>
          <svg xmlns="http://www.w3.org/2000/svg" class="w-24 h-24 text-primary mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 13l2-2m0 0l7-7 4 4 2 2m-9-2v8m0 0H7a2 2 0 01-2-2v-1m10-5l2 2m0 0l3 3-2 2-3-3z" />
          </svg>
          <p class="text-center font-semibold">Current Vehicle Being Serviced</p>
          <p class="text-sm text-gray-600 mt-1 text-center">Ford Mustang GT - License #123XYZ</p>
        </div>
      </div>
    </section>

    <!-- Schedule Button -->
    <section class="mb-10">
      <button id="schedule-btn" class="bg-primary rounded px-6 py-2 text-white font-semibold hover:bg-primary/90 focus:outline-none">Schedule</button>
    </section>

  </main>

  <!-- View Shed Modal -->
  <div id="shed-view-modal" class="fixed inset-0 z-50 hidden modal-bg flex justify-center items-center p-6">
    <div class="bg-white shadow-lg rounded-lg max-w-md w-full max-h-[90vh] flex flex-col overflow-hidden relative">
      <button id="view-modal-close" aria-label="Close" class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none z-10">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>
      <div id="view-modal-content" class="p-6 overflow-auto flex-grow text-gray-800">
        <!-- Dynamic shed details -->
      </div>
    </div>
  </div>

  <!-- Schedule Modal -->
  <div id="schedule-modal" class="fixed inset-0 z-50 hidden modal-bg flex justify-center items-center p-6 overflow-auto">
    <div class="bg-white rounded-lg shadow-lg max-w-7xl w-full max-h-[90vh] flex flex-col md:flex-row overflow-hidden relative">

      <button id="schedule-modal-close" aria-label="Close" class="absolute top-4 right-4 z-10 text-gray-600 hover:text-gray-900 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>

      <!-- Left panel: Vehicles -->
      <section class="md:w-2/5 bg-gray-100 p-6 overflow-auto border-r border-gray-300">
        <h3 class="text-primary font-semibold mb-4">Vehicles to Schedule</h3>
        <div id="vehicles-panel" class="space-y-4">
          <!-- Vehicle cards injected here -->
        </div>
      </section>

      <!-- Center panel: Selected Vehicle & Mechanics -->
      <section class="md:w-3/5 p-6 overflow-auto flex flex-col">
        <h3 class="text-primary font-semibold mb-4">Scheduled Vehicle & Mechanics</h3>
        <div id="selected-vehicle" class="mb-4">
          <p class="text-gray-500">Select a vehicle from the left panel</p>
        </div>
        <h4 class="font-semibold mb-2">Assigned Mechanics</h4>
        <div id="assigned-mechanics" class="space-y-4">
          <!-- Assigned mechanic cards here -->
        </div>
      </section>

      <!-- Right panel: Mechanics -->
      <section class="md:w-2/5 bg-gray-100 p-6 overflow-auto border-l border-gray-300">
        <h3 class="text-primary font-semibold mb-4">Mechanics</h3>
        <div id="mechanics-panel" class="space-y-4">
          <!-- Mechanics cards injected here -->
        </div>
      </section>
    </div>
  </div>

  <script>
    // Wrap everything in DOMContentLoaded
    document.addEventListener('DOMContentLoaded', () => {

      // Shed data
      const sheds = {
        1: {
          id: 1,
          vehicle: 'Toyota Corolla',
          info: 'Toyota Corolla - Service due date: 2025-12-15, Last serviced: 2025-06-10',
          count: 0,
        },
        2: {
          id: 2,
          vehicle: 'Honda Civic',
          info: 'Honda Civic - Service due date: 2025-11-20, Last serviced: 2025-05-29',
          count: 0,
        }
      };

      // Mechanics static data
      const mechanics = [
        { id: 1, name: 'John Doe', specialty: 'Engine Specialist' },
        { id: 2, name: 'Jane Smith', specialty: 'Transmission Expert' },
        { id: 3, name: 'Carlos Reyes', specialty: 'Electrical Systems' }
      ];

      // Vehicles to schedule
      const vehiclesToSchedule = [
        { id: 101, model: 'Ford Mustang GT', license: '123XYZ' },
        { id: 102, model: 'Chevrolet Camaro', license: '567ABC' },
        { id: 103, model: 'Tesla Model 3', license: 'TESLA3' },
      ];

      // Elements
      const viewModal = document.getElementById('shed-view-modal');
      const viewModalContent = document.getElementById('view-modal-content');
      const viewModalClose = document.getElementById('view-modal-close');

      const scheduleModal = document.getElementById('schedule-modal');
      const scheduleBtn = document.getElementById('schedule-btn');
      const scheduleModalClose = document.getElementById('schedule-modal-close');

      const autoScheduleToggle = document.getElementById('auto-schedule-toggle');

      const vehiclesPanel = document.getElementById('vehicles-panel');
      const mechanicsPanel = document.getElementById('mechanics-panel');
      const selectedVehicleContainer = document.getElementById('selected-vehicle');
      const assignedMechanicsContainer = document.getElementById('assigned-mechanics');

      // Render vehicle cards in left panel
      function renderVehiclesPanel() {
        vehiclesPanel.innerHTML = '';
        vehiclesToSchedule.forEach(v => {
          const card = document.createElement('div');
          card.className = 'bg-white p-4 rounded shadow cursor-pointer hover:shadow-md relative';
          card.innerHTML = `
            <p class="font-semibold">${v.model}</p>
            <p class="text-sm text-gray-600">License: ${v.license}</p>
            <button class="absolute bottom-2 right-2 border border-primary text-primary rounded px-3 py-1 text-sm hover:bg-primary hover:text-white transition" data-select-vehicle="${v.id}">Select</button>
          `;
          vehiclesPanel.appendChild(card);
        });
      }

      // Render mechanic cards in right panel
      function renderMechanicsPanel() {
        mechanicsPanel.innerHTML = '';
        mechanics.forEach(m => {
          const card = document.createElement('div');
          card.className = 'bg-white p-4 rounded shadow flex flex-col';
          card.innerHTML = `
            <p class="font-semibold">${m.name}</p>
            <p class="text-sm text-gray-600">${m.specialty}</p>
            <button class="mt-auto bg-primary text-white rounded px-3 py-1 hover:bg-primary/90 transition assign-btn" data-assign-mechanic="${m.id}">Assign</button>
          `;
          mechanicsPanel.appendChild(card);
        });
      }

      let selectedVehicle = null;
      let assignedMechanics = [];

      // Display selected vehicle in center panel
      function renderSelectedVehicle() {
        if (!selectedVehicle) {
          selectedVehicleContainer.innerHTML = '<p class="text-gray-500">Select a vehicle from the left panel</p>';
          assignedMechanicsContainer.innerHTML = '';
          return;
        }
        selectedVehicleContainer.innerHTML = `
          <div class="bg-white shadow rounded p-4">
            <p class="font-semibold text-lg">${selectedVehicle.model}</p>
            <p class="text-sm text-gray-700">License: ${selectedVehicle.license}</p>
          </div>
        `;
      }

      // Display assigned mechanics in center panel
      function renderAssignedMechanics() {
        assignedMechanicsContainer.innerHTML = '';
        assignedMechanics.forEach(m => {
          const mechCard = document.createElement('div');
          mechCard.className = 'bg-white p-3 rounded shadow flex justify-between items-center';
          mechCard.innerHTML = `
            <div>
              <p class="font-semibold">${m.name}</p>
              <p class="text-sm text-gray-700">${m.specialty}</p>
            </div>
            <button class="text-red-600 hover:text-red-800 focus:outline-none remove-mechanic-btn" data-remove-mechanic="${m.id}" aria-label="Remove mechanic">&times;</button>
          `;
          assignedMechanicsContainer.appendChild(mechCard);
        });
      }

      // Vehicle selection event
      vehiclesPanel.addEventListener('click', e => {
        const selectBtn = e.target.closest('[data-select-vehicle]');
        if (selectBtn) {
          const id = parseInt(selectBtn.getAttribute('data-select-vehicle'));
          selectedVehicle = vehiclesToSchedule.find(v => v.id === id);
          assignedMechanics = [];
          renderSelectedVehicle();
          renderAssignedMechanics();
        }
      });

      // Mechanic assign event
      mechanicsPanel.addEventListener('click', e => {
        const assignBtn = e.target.closest('[data-assign-mechanic]');
        if (assignBtn) {
          if (!selectedVehicle) {
            alert('Please select a vehicle first');
            return;
          }
          const mechId = parseInt(assignBtn.getAttribute('data-assign-mechanic'));
          if (!assignedMechanics.some(m => m.id === mechId)) {
            const mech = mechanics.find(m => m.id === mechId);
            assignedMechanics.push(mech);
            renderAssignedMechanics();
          }
        }
      });

      // Remove assigned mechanic event
      assignedMechanicsContainer.addEventListener('click', e => {
        const removeBtn = e.target.closest('[data-remove-mechanic]');
        if (removeBtn) {
          const remId = parseInt(removeBtn.getAttribute('data-remove-mechanic'));
          assignedMechanics = assignedMechanics.filter(m => m.id !== remId);
          renderAssignedMechanics();
        }
      });

      // View modal toggle and content
      document.querySelectorAll('[data-view-shed]').forEach(btn => {
        btn.addEventListener('click', e => {
          const shedId = e.target.getAttribute('data-view-shed');
          const shed = sheds[shedId];
          if (shed) {
            viewModalContent.innerHTML = `
              <h2 class="text-xl font-semibold mb-4">Shed ${shed.id} Details</h2>
              <p>${shed.info}</p>
            `;
            viewModal.classList.remove('hidden');
          }
        });
      });

      viewModalClose.addEventListener('click', () => {
        viewModal.classList.add('hidden');
      });

      // Update sheds buttons toggle counter UI
      document.querySelectorAll('[data-update-shed]').forEach(btn => {
        btn.addEventListener('click', e => {
          const parent = e.target.closest('div');
          const counter = parent.querySelector('.update-counter');
          const updateBtn = parent.querySelector('.update-status-btn');
          if (counter && updateBtn) {
            counter.classList.toggle('hidden');
            updateBtn.classList.toggle('hidden');
            // Reset counter display to 0 on toggle open
            if (!counter.classList.contains('hidden')) {
              counter.querySelector('.counter-value').textContent = '0';
            }
          }
        });
      });

      // Increment / decrement counter logic with update button show/hide
      document.querySelectorAll('.update-counter').forEach(counterDiv => {
        const incBtn = counterDiv.querySelector('.btn-increment');
        const decBtn = counterDiv.querySelector('.btn-decrement');
        const countSpan = counterDiv.querySelector('.counter-value');
        const updateBtn = counterDiv.nextElementSibling;

        let count = 0;

        incBtn.addEventListener('click', () => {
          count++;
          countSpan.textContent = count;
          if (updateBtn.classList.contains('hidden')) {
            updateBtn.classList.remove('hidden');
          }
        });

        decBtn.addEventListener('click', () => {
          if (count > 0) {
            count--;
            countSpan.textContent = count;
            if (updateBtn.classList.contains('hidden')) {
              updateBtn.classList.remove('hidden');
            }
          }
        });
      });

      // Update final count button click
      document.querySelectorAll('.update-status-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          const parent = e.target.closest('div');
          const shedHeader = parent.querySelector('h3');
          const shedId = shedHeader ? shedHeader.textContent.match(/\d+/)[0] : null;
          if (shedId) {
            const counterDiv = parent.querySelector('.update-counter');
            const countVal = counterDiv.querySelector('.counter-value').textContent;
            sheds[shedId].count = parseInt(countVal) || 0;
            alert(`Shed ${shedId} updated count: ${sheds[shedId].count}`);
            // Hide counter and update button after update
            counterDiv.classList.add('hidden');
            e.target.classList.add('hidden');
            counterDiv.querySelector('.counter-value').textContent = "0";
          }
        });
      });

      // Auto schedule toggle alert feedback
      autoScheduleToggle.addEventListener('change', () => {
        const msg = autoScheduleToggle.checked ? 'Auto schedule enabled' : 'Auto schedule disabled';
        alert(msg);
      });

      // Schedule modal open and close
      scheduleBtn.addEventListener('click', () => {
        scheduleModal.classList.remove('hidden');
        renderVehiclesPanel();
        renderMechanicsPanel();
        renderSelectedVehicle();
        renderAssignedMechanics();
      });

      scheduleModalClose.addEventListener('click', () => {
        scheduleModal.classList.add('hidden');
        selectedVehicle = null;
        assignedMechanics = [];
        renderSelectedVehicle();
        renderAssignedMechanics();
      });

      // Responsive adjustment for schedule modal panels on mobile
      function adjustScheduleModalForMobile() {
        const container = scheduleModal.querySelector('div > div');
        if (!container) return;

        if (window.innerWidth < 640) {
          container.style.flexDirection = 'column';
          ['section'].forEach(tag => {
            Array.from(container.querySelectorAll(tag)).forEach(section => {
              section.style.width = '100%';
              section.style.borderRight = 'none';
              section.style.borderLeft = 'none';
              section.style.borderBottom = '1px solid #d1d5db';
              section.style.borderTop = 'none';
              section.style.paddingBottom = '1rem';
              section.style.paddingTop = '1rem';
            });
          });
          container.querySelector('section:nth-child(1)').style.borderBottom = '1px solid #d1d5db';
          container.querySelector('section:nth-child(2)').style.borderBottom = '1px solid #d1d5db';
          container.querySelector('section:nth-child(3)').style.borderBottom = 'none';
        } else {
          container.style.flexDirection = 'row';
          container.querySelector('section:nth-child(1)').style.width = '40%';
          container.querySelector('section:nth-child(2)').style.width = '60%';
          container.querySelector('section:nth-child(3)').style.width = '40%';
          container.querySelector('section:nth-child(1)').style.borderRight = '1px solid #d1d5db';
          container.querySelector('section:nth-child(3)').style.borderLeft = '1px solid #d1d5db';
          container.querySelector('section:nth-child(1)').style.borderBottom = 'none';
          container.querySelector('section:nth-child(3)').style.borderTop = 'none';
        }
      }

      window.addEventListener('resize', adjustScheduleModalForMobile);
      adjustScheduleModalForMobile();

    });
  </script>
</body>
</html>
